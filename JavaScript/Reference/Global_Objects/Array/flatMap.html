<!DOCTYPE html><html lang="en-US" prefix="og: https://ogp.me/ns#"><!-- Mirrored from developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 08 Jan 2025 13:10:01 GMT --><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="https://developer.mozilla.org/favicon-48x48.bc390275e955dacb2e65.png"><link rel="apple-touch-icon" href="https://developer.mozilla.org/apple-touch-icon.528534bba673c38049c2.png"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="https://developer.mozilla.org/manifest.f42880861b394dd4dc9b.json"><link rel="search" type="application/opensearchdescription+xml" href="https://developer.mozilla.org/opensearch.xml" title="MDN Web Docs"><title>Array.prototype.flatMap()</title><link rel="alternate" title="Array.prototype.flatMap()" href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" hreflang="de"><link rel="alternate" title="Array.prototype.flatMap()" href="https://developer.mozilla.org/es/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" hreflang="es"><link rel="alternate" title="Array.prototype.flatMap()" href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" hreflang="fr"><link rel="alternate" title="Array.prototype.flatMap()" href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" hreflang="ja"><link rel="alternate" title="Array.prototype.flatMap()" href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" hreflang="ko"><link rel="alternate" title="Array.prototype.flatMap()" href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" hreflang="pt"><link rel="alternate" title="Array.prototype.flatMap()" href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" hreflang="ru"><link rel="alternate" title="Array.prototype.flatMap()" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" hreflang="zh"><link rel="alternate" title="Array.prototype.flatMap()" href="flatMap.html" hreflang="en"><link rel="preload" as="font" type="font/woff2" href="https://developer.mozilla.org/static/media/Inter.var.c2fe3cb2b7c746f7966a.woff2" crossorigin=""><link rel="alternate" type="application/rss+xml" title="MDN Blog RSS Feed" href="https://developer.mozilla.org/en-US/blog/rss.xml" hreflang="en"><meta name="description" content="The flatMap() method of Array instances returns a new array formed by applying a given callback function to each element of the array, and then flattening the result by one level. It is identical to a map() followed by a flat() of depth 1 (arr.map(...args).flat()), but slightly more efficient than calling those two methods separately."><meta property="og:url" content="flatMap.html"><meta property="og:title" content="Array.prototype.flatMap() - JavaScript | MDN"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:description" content="The flatMap() method of Array instances returns a new array formed by applying a given callback function to each element of the array, and then flattening the result by one level. It is identical to a map() followed by a flat() of depth 1 (arr.map(...args).flat()), but slightly more efficient than calling those two methods separately."><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.d893525a4fb5fb1f67a2.png"><meta property="og:image:type" content="image/png"><meta property="og:image:height" content="1080"><meta property="og:image:width" content="1920"><meta property="og:image:alt" content="The MDN Web Docs logo, featuring a blue accent color, displayed on a solid black background."><meta property="og:site_name" content="MDN Web Docs"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="MozDevNet"><link rel="canonical" href="flatMap.html"><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.on-github,.page-footer,.place,.sidebar,.top-banner,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><link href="https://developer.mozilla.org/static/css/main.65aa8eed.css" rel="stylesheet"></head><body><script>if(document.body.addEventListener("load",(t=>{t.target.classList.contains("interactive")&&t.target.setAttribute("data-readystate","complete")}),{capture:!0}),window&&document.documentElement){const t={light:"#ffffff",dark:"#1b1b1b"};try{const e=window.localStorage.getItem("theme");e&&(document.documentElement.className=e,document.documentElement.style.backgroundColor=t[e]);const o=window.localStorage.getItem("nop");o&&(document.documentElement.dataset.nop=o)}catch(t){console.warn("Unable to read theme from localStorage",t)}}</script><div id="root"><div class="page-wrapper  category-javascript document-page"><div class="main-wrapper"><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><header><h1>Array.prototype.flatMap()</h1><details class="baseline-indicator high"><summary><span class="indicator" role="img" aria-label="Baseline Check"></span><h2>Baseline<!-- --> <span class="not-bold">Widely available</span></h2><div class="browsers"><span class="engine" title="Supported in Chrome and Edge"><span class="browser chrome supported" role="img" aria-label="Chrome check"></span><span class="browser edge supported" role="img" aria-label="Edge check"></span></span><span class="engine" title="Supported in Firefox"><span class="browser firefox supported" role="img" aria-label="Firefox check"></span></span><span class="engine" title="Supported in Safari"><span class="browser safari supported" role="img" aria-label="Safari check"></span></span></div><span class="icon icon-chevron "></span></summary><div class="extra"><p>This feature is well established and works across many devices and browser versions. It’s been available across browsers since<!-- --> <!-- -->January 2020<!-- -->.</p><ul><li><a href="https://developer.mozilla.org/en-US/docs/Glossary/Baseline/Compatibility" data-glean="baseline_link_learn_more" target="_blank" class="learn-more">Learn more</a></li><li><a href="#browser_compatibility" data-glean="baseline_link_bcd_table">See full compatibility</a></li><li><a href="https://survey.alchemer.com/s3/7634825/MDN-baseline-feedback?page=%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FArray%2FflatMap&amp;level=high" data-glean="baseline_link_feedback" class="feedback-link" target="_blank" rel="noreferrer">Report feedback</a></li></ul></div></details></header><div class="section-content"><p>The <strong><code>flatMap()</code></strong> method of <a href="../Array.html"><code>Array</code></a> instances returns a new array formed by applying a given callback function to each element of the array, and then flattening the result by one level. It is identical to a <a href="map.html"><code>map()</code></a> followed by a <a href="flat.html"><code>flat()</code></a> of depth 1 (<code>arr.map(...args).flat()</code>), but slightly more efficient than calling those two methods separately.</p></div><section aria-labelledby="try_it"><h2 id="try_it"><a href="#try_it">Try it</a></h2><div class="section-content"><iframe class="interactive is-shorter-height" height="200" src="https://interactive-examples.mdn.mozilla.net/pages/js/array-flatmap.html" title="MDN Web Docs Interactive Example" allow="clipboard-write" loading="lazy"></iframe></div></section><section aria-labelledby="syntax"><h2 id="syntax"><a href="#syntax">Syntax</a></h2><div class="section-content"><div class="code-example"><div class="example-header"><span class="language-name">js</span></div><pre class="brush: js notranslate"><code>flatMap(callbackFn)
flatMap(callbackFn, thisArg)
</code></pre></div></div></section><section aria-labelledby="parameters"><h3 id="parameters"><a href="#parameters">Parameters</a></h3><div class="section-content"><dl>
<dt id="callbackfn"><a href="#callbackfn"><code>callbackFn</code></a></dt>
<dd>
<p>A function to execute for each element in the array. It should return an array containing new elements of the new array, or a single non-array value to be added to the new array. The function is called with the following arguments:</p>
<dl>
<dt id="element"><a href="#element"><code>element</code></a></dt>
<dd>
<p>The current element being processed in the array.</p>
</dd>
<dt id="index"><a href="#index"><code>index</code></a></dt>
<dd>
<p>The index of the current element being processed in the array.</p>
</dd>
<dt id="array"><a href="#array"><code>array</code></a></dt>
<dd>
<p>The array <code>flatMap()</code> was called upon.</p>
</dd>
</dl>
</dd>
<dt id="thisarg"><a href="#thisarg"><code>thisArg</code> <span class="badge inline optional">Optional</span></a></dt>
<dd>
<p>A value to use as <code>this</code> when executing <code>callbackFn</code>. See <a href="../Array.html#iterative_methods">iterative methods</a>.</p>
</dd>
</dl></div></section><section aria-labelledby="return_value"><h3 id="return_value"><a href="#return_value">Return value</a></h3><div class="section-content"><p>A new array with each element being the result of the callback function and flattened
by a depth of 1.</p></div></section><section aria-labelledby="description"><h2 id="description"><a href="#description">Description</a></h2><div class="section-content"><p>The <code>flatMap()</code> method is an <a href="../Array.html#iterative_methods">iterative method</a>. See <a href="map.html"><code>Array.prototype.map()</code></a> for a detailed description of the callback function. The <code>flatMap()</code> method is identical to <a href="map.html"><code>map(callbackFn, thisArg)</code></a> followed by <a href="flat.html"><code>flat(1)</code></a> — for each element, it produces an array of new elements, and concatenates the resulting arrays together to form a new array. Read the <a href="../Array.html#iterative_methods">iterative methods</a> section for more information about how these methods work in general.</p>
<p>The <code>flatMap()</code> method is <a href="../Array.html#generic_array_methods">generic</a>. It only expects the <code>this</code> value to have a <code>length</code> property and integer-keyed properties. However, the value returned from <code>callbackFn</code> must be an array if it is to be flattened.</p></div></section><section aria-labelledby="alternative"><h3 id="alternative"><a href="#alternative">Alternative</a></h3><div class="section-content"><h4 id="pre-allocate_and_explicitly_iterate">Pre-allocate and explicitly iterate</h4>
<div class="code-example"><div class="example-header"><span class="language-name">js</span></div><pre class="brush: js notranslate"><code>const arr = [1, 2, 3, 4];

arr.flatMap((x) =&gt; [x, x * 2]);
// is equivalent to
const n = arr.length;
const acc = new Array(n * 2);
for (let i = 0; i &lt; n; i++) {
  const x = arr[i];
  acc[i * 2] = x;
  acc[i * 2 + 1] = x * 2;
}
// [1, 2, 2, 4, 3, 6, 4, 8]
</code></pre></div>
<p>Note that in this particular case the <code>flatMap</code> approach is slower than the
for-loop approach — due to the creation of temporary arrays that must be
garbage collected, as well as the return array not needing to be frequently
resized. However, <code>flatMap</code> may still be the correct solution in cases where
its flexibility and readability are desired.</p></div></section><section aria-labelledby="examples"><h2 id="examples"><a href="#examples">Examples</a></h2><div class="section-content"></div></section><section aria-labelledby="map_and_flatmap"><h3 id="map_and_flatmap"><a href="#map_and_flatmap">map() and flatMap()</a></h3><div class="section-content"><div class="code-example"><div class="example-header"><span class="language-name">js</span></div><pre class="brush: js notranslate"><code>const arr1 = [1, 2, 3, 4];

arr1.map((x) =&gt; [x * 2]);
// [[2], [4], [6], [8]]

arr1.flatMap((x) =&gt; [x * 2]);
// [2, 4, 6, 8]

// only one level is flattened
arr1.flatMap((x) =&gt; [[x * 2]]);
// [[2], [4], [6], [8]]
</code></pre></div>
<p>While the above could have been achieved by using map itself, here is an example that
better showcases the use of <code>flatMap()</code>.</p>
<p>Let's generate a list of words from a list of sentences.</p>
<div class="code-example"><div class="example-header"><span class="language-name">js</span></div><pre class="brush: js notranslate"><code>const arr1 = ["it's Sunny in", "", "California"];

arr1.map((x) =&gt; x.split(" "));
// [["it's","Sunny","in"],[""],["California"]]

arr1.flatMap((x) =&gt; x.split(" "));
// ["it's","Sunny","in", "", "California"]
</code></pre></div>
<p>Notice, the output list length can be different from the input list length.</p></div></section><section aria-labelledby="for_adding_and_removing_items_during_a_map"><h3 id="for_adding_and_removing_items_during_a_map"><a href="#for_adding_and_removing_items_during_a_map">For adding and removing items during a map()</a></h3><div class="section-content"><p><code>flatMap</code> can be used as a way to add and remove items (modify the number of
items) during a <code>map</code>. In other words, it allows you to map <em>many items to
many items</em> (by handling each input item separately), rather than always
<em>one-to-one</em>. In this sense, it works like the opposite of <a href="filter.html">filter</a>.
Return a 1-element array to keep the item, a multiple-element array to add items, or a
0-element array to remove the item.</p>
<div class="code-example"><div class="example-header"><span class="language-name">js</span></div><pre class="brush: js notranslate"><code>// Let's say we want to remove all the negative numbers
// and split the odd numbers into an even number and a 1
const a = [5, 4, -3, 20, 17, -33, -4, 18];
//         |\  \  x   |  | \   x   x   |
//        [4,1, 4,   20, 16, 1,       18]

const result = a.flatMap((n) =&gt; {
  if (n &lt; 0) {
    return [];
  }
  return n % 2 === 0 ? [n] : [n - 1, 1];
});
console.log(result); // [4, 1, 4, 20, 16, 1, 18]
</code></pre></div></div></section><section aria-labelledby="using_the_third_argument_of_callbackfn"><h3 id="using_the_third_argument_of_callbackfn"><a href="#using_the_third_argument_of_callbackfn">Using the third argument of callbackFn</a></h3><div class="section-content"><p>The <code>array</code> argument is useful if you want to access another element in the array, especially when you don't have an existing variable that refers to the array. The following example first uses <code>filter()</code> to extract operational stations and then uses <code>flatMap()</code> to create a new array where each element contains a station and its next station. On the last station, it returns an empty array to exclude it from the final array.</p>
<div class="code-example"><div class="example-header"><span class="language-name">js</span></div><pre class="brush: js notranslate"><code>const stations = ["New Haven", "West Haven", "Milford (closed)", "Stratford"];
const line = stations
  .filter((name) =&gt; !name.endsWith("(closed)"))
  .flatMap((name, idx, arr) =&gt; {
    // Without the arr argument, there's no way to easily access the
    // intermediate array without saving it to a variable.
    if (idx === arr.length - 1) return []; // last station has no next station
    return [`${name} - ${arr[idx + 1]}`];
  });
console.log(line); // ['New Haven - West Haven', 'West Haven - Stratford']
</code></pre></div>
<p>The <code>array</code> argument is <em>not</em> the array that is being built — there is no way to access the array being built from the callback function.</p></div></section><section aria-labelledby="using_flatmap_on_sparse_arrays"><h3 id="using_flatmap_on_sparse_arrays"><a href="#using_flatmap_on_sparse_arrays">Using flatMap() on sparse arrays</a></h3><div class="section-content"><p>The <code>callbackFn</code> won't be called for empty slots in the source array because <code>map()</code> doesn't, while <code>flat()</code> ignores empty slots in the returned arrays.</p>
<div class="code-example"><div class="example-header"><span class="language-name">js</span></div><pre class="brush: js notranslate"><code>console.log([1, 2, , 4, 5].flatMap((x) =&gt; [x, x * 2])); // [1, 2, 2, 4, 4, 8, 5, 10]
console.log([1, 2, 3, 4].flatMap((x) =&gt; [, x * 2])); // [2, 4, 6, 8]
</code></pre></div></div></section><section aria-labelledby="calling_flatmap_on_non-array_objects"><h3 id="calling_flatmap_on_non-array_objects"><a href="#calling_flatmap_on_non-array_objects">Calling flatMap() on non-array objects</a></h3><div class="section-content"><p>The <code>flatMap()</code> method reads the <code>length</code> property of <code>this</code> and then accesses each property whose key is a nonnegative integer less than <code>length</code>. If the return value of the callback function is not an array, it is always directly appended to the result array.</p>
<div class="code-example"><div class="example-header"><span class="language-name">js</span></div><pre class="brush: js notranslate"><code>const arrayLike = {
  length: 3,
  0: 1,
  1: 2,
  2: 3,
  3: 4, // ignored by flatMap() since length is 3
};
console.log(Array.prototype.flatMap.call(arrayLike, (x) =&gt; [x, x * 2]));
// [1, 2, 2, 4, 3, 6]

// Array-like objects returned from the callback won't be flattened
console.log(
  Array.prototype.flatMap.call(arrayLike, (x) =&gt; ({
    length: 1,
    0: x,
  })),
);
// [ { '0': 1, length: 1 }, { '0': 2, length: 1 }, { '0': 3, length: 1 } ]
</code></pre></div></div></section><h2 id="specifications"><a href="#specifications">Specifications</a></h2><table class="standard-table"><thead><tr><th scope="col">Specification</th></tr></thead><tbody><tr><td><a href="https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.flatmap">ECMAScript Language Specification<!-- --> <br><small># <!-- -->sec-array.prototype.flatmap</small></a></td></tr></tbody></table><h2 id="browser_compatibility"><a href="#browser_compatibility">Browser compatibility</a></h2><p>BCD tables only load in the browser<noscript> <!-- -->with JavaScript enabled. Enable JavaScript to view data.</noscript></p><section aria-labelledby="see_also"><h2 id="see_also"><a href="#see_also">See also</a></h2><div class="section-content"><ul>
<li><a href="https://github.com/zloirock/core-js#ecmascript-array" class="external" target="_blank">Polyfill of <code>Array.prototype.flatMap</code> in <code>core-js</code></a></li>
<li><a href="../../../Guide/Indexed_collections.html">Indexed collections</a> guide</li>
<li><a href="../Array.html"><code>Array</code></a></li>
<li><a href="concat.html"><code>Array.prototype.concat()</code></a></li>
<li><a href="flat.html"><code>Array.prototype.flat()</code></a></li>
<li><a href="map.html"><code>Array.prototype.map()</code></a></li>
<li><a href="reduce.html"><code>Array.prototype.reduce()</code></a></li>
</ul></div></section></article></main></div></div></div><script type="application/json" id="hydration">{"url":"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap","doc":{"body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>The <strong><code>flatMap()</code></strong> method of <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array\"><code>Array</code></a> instances returns a new array formed by applying a given callback function to each element of the array, and then flattening the result by one level. It is identical to a <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map\"><code>map()</code></a> followed by a <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat\"><code>flat()</code></a> of depth 1 (<code>arr.map(...args).flat()</code>), but slightly more efficient than calling those two methods separately.</p>"}},{"type":"prose","value":{"id":"try_it","title":"Try it","isH3":false,"content":"<iframe class=\"interactive is-shorter-height\" height=\"200\" src=\"https://interactive-examples.mdn.mozilla.net/pages/js/array-flatmap.html\" title=\"MDN Web Docs Interactive Example\" allow=\"clipboard-write\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>flatMap(callbackFn)\nflatMap(callbackFn, thisArg)\n</code></pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n<dt id=\"callbackfn\"><a href=\"#callbackfn\"><code>callbackFn</code></a></dt>\n<dd>\n<p>A function to execute for each element in the array. It should return an array containing new elements of the new array, or a single non-array value to be added to the new array. The function is called with the following arguments:</p>\n<dl>\n<dt id=\"element\"><a href=\"#element\"><code>element</code></a></dt>\n<dd>\n<p>The current element being processed in the array.</p>\n</dd>\n<dt id=\"index\"><a href=\"#index\"><code>index</code></a></dt>\n<dd>\n<p>The index of the current element being processed in the array.</p>\n</dd>\n<dt id=\"array\"><a href=\"#array\"><code>array</code></a></dt>\n<dd>\n<p>The array <code>flatMap()</code> was called upon.</p>\n</dd>\n</dl>\n</dd>\n<dt id=\"thisarg\"><a href=\"#thisarg\"><code>thisArg</code> <span class=\"badge inline optional\">Optional</span></a></dt>\n<dd>\n<p>A value to use as <code>this</code> when executing <code>callbackFn</code>. See <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#iterative_methods\">iterative methods</a>.</p>\n</dd>\n</dl>"}},{"type":"prose","value":{"id":"return_value","title":"Return value","isH3":true,"content":"<p>A new array with each element being the result of the callback function and flattened\nby a depth of 1.</p>"}},{"type":"prose","value":{"id":"description","title":"Description","isH3":false,"content":"<p>The <code>flatMap()</code> method is an <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#iterative_methods\">iterative method</a>. See <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map\"><code>Array.prototype.map()</code></a> for a detailed description of the callback function. The <code>flatMap()</code> method is identical to <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map\"><code>map(callbackFn, thisArg)</code></a> followed by <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat\"><code>flat(1)</code></a> — for each element, it produces an array of new elements, and concatenates the resulting arrays together to form a new array. Read the <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#iterative_methods\">iterative methods</a> section for more information about how these methods work in general.</p>\n<p>The <code>flatMap()</code> method is <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#generic_array_methods\">generic</a>. It only expects the <code>this</code> value to have a <code>length</code> property and integer-keyed properties. However, the value returned from <code>callbackFn</code> must be an array if it is to be flattened.</p>"}},{"type":"prose","value":{"id":"alternative","title":"Alternative","isH3":true,"content":"<h4 id=\"pre-allocate_and_explicitly_iterate\">Pre-allocate and explicitly iterate</4>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>const arr = [1, 2, 3, 4];\n\narr.flatMap((x) =&gt; [x, x * 2]);\n// is equivalent to\nconst n = arr.length;\nconst acc = new Array(n * 2);\nfor (let i = 0; i &lt; n; i++) {\n  const x = arr[i];\n  acc[i * 2] = x;\n  acc[i * 2 + 1] = x * 2;\n}\n// [1, 2, 2, 4, 3, 6, 4, 8]\n</code></pre></div>\n<p>Note that in this particular case the <code>flatMap</code> approach is slower than the\nfor-loop approach — due to the creation of temporary arrays that must be\ngarbage collected, as well as the return array not needing to be frequently\nresized. However, <code>flatMap</code> may still be the correct solution in cases where\nits flexibility and readability are desired.</p>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":""}},{"type":"prose","value":{"id":"map_and_flatmap","title":"map() and flatMap()","isH3":true,"content":"<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>const arr1 = [1, 2, 3, 4];\n\narr1.map((x) =&gt; [x * 2]);\n// [[2], [4], [6], [8]]\n\narr1.flatMap((x) =&gt; [x * 2]);\n// [2, 4, 6, 8]\n\n// only one level is flattened\narr1.flatMap((x) =&gt; [[x * 2]]);\n// [[2], [4], [6], [8]]\n</code></pre></div>\n<p>While the above could have been achieved by using map itself, here is an example that\nbetter showcases the use of <code>flatMap()</code>.</p>\n<p>Let's generate a list of words from a list of sentences.</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>const arr1 = [\"it's Sunny in\", \"\", \"California\"];\n\narr1.map((x) =&gt; x.split(\" \"));\n// [[\"it's\",\"Sunny\",\"in\"],[\"\"],[\"California\"]]\n\narr1.flatMap((x) =&gt; x.split(\" \"));\n// [\"it's\",\"Sunny\",\"in\", \"\", \"California\"]\n</code></pre></div>\n<p>Notice, the output list length can be different from the input list length.</p>"}},{"type":"prose","value":{"id":"for_adding_and_removing_items_during_a_map","title":"For adding and removing items during a map()","isH3":true,"content":"<p><code>flatMap</code> can be used as a way to add and remove items (modify the number of\nitems) during a <code>map</code>. In other words, it allows you to map <em>many items to\nmany items</em> (by handling each input item separately), rather than always\n<em>one-to-one</em>. In this sense, it works like the opposite of <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter\">filter</a>.\nReturn a 1-element array to keep the item, a multiple-element array to add items, or a\n0-element array to remove the item.</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>// Let's say we want to remove all the negative numbers\n// and split the odd numbers into an even number and a 1\nconst a = [5, 4, -3, 20, 17, -33, -4, 18];\n//         |\\  \\  x   |  | \\   x   x   |\n//        [4,1, 4,   20, 16, 1,       18]\n\nconst result = a.flatMap((n) =&gt; {\n  if (n &lt; 0) {\n    return [];\n  }\n  return n % 2 === 0 ? [n] : [n - 1, 1];\n});\nconsole.log(result); // [4, 1, 4, 20, 16, 1, 18]\n</code></pre></div>"}},{"type":"prose","value":{"id":"using_the_third_argument_of_callbackfn","title":"Using the third argument of callbackFn","isH3":true,"content":"<p>The <code>array</code> argument is useful if you want to access another element in the array, especially when you don't have an existing variable that refers to the array. The following example first uses <code>filter()</code> to extract operational stations and then uses <code>flatMap()</code> to create a new array where each element contains a station and its next station. On the last station, it returns an empty array to exclude it from the final array.</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>const stations = [\"New Haven\", \"West Haven\", \"Milford (closed)\", \"Stratford\"];\nconst line = stations\n  .filter((name) =&gt; !name.endsWith(\"(closed)\"))\n  .flatMap((name, idx, arr) =&gt; {\n    // Without the arr argument, there's no way to easily access the\n    // intermediate array without saving it to a variable.\n    if (idx === arr.length - 1) return []; // last station has no next station\n    return [`${name} - ${arr[idx + 1]}`];\n  });\nconsole.log(line); // ['New Haven - West Haven', 'West Haven - Stratford']\n</code></pre></div>\n<p>The <code>array</code> argument is <em>not</em> the array that is being built — there is no way to access the array being built from the callback function.</p>"}},{"type":"prose","value":{"id":"using_flatmap_on_sparse_arrays","title":"Using flatMap() on sparse arrays","isH3":true,"content":"<p>The <code>callbackFn</code> won't be called for empty slots in the source array because <code>map()</code> doesn't, while <code>flat()</code> ignores empty slots in the returned arrays.</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>console.log([1, 2, , 4, 5].flatMap((x) =&gt; [x, x * 2])); // [1, 2, 2, 4, 4, 8, 5, 10]\nconsole.log([1, 2, 3, 4].flatMap((x) =&gt; [, x * 2])); // [2, 4, 6, 8]\n</code></pre></div>"}},{"type":"prose","value":{"id":"calling_flatmap_on_non-array_objects","title":"Calling flatMap() on non-array objects","isH3":true,"content":"<p>The <code>flatMap()</code> method reads the <code>length</code> property of <code>this</code> and then accesses each property whose key is a nonnegative integer less than <code>length</code>. If the return value of the callback function is not an array, it is always directly appended to the result array.</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>const arrayLike = {\n  length: 3,\n  0: 1,\n  1: 2,\n  2: 3,\n  3: 4, // ignored by flatMap() since length is 3\n};\nconsole.log(Array.prototype.flatMap.call(arrayLike, (x) =&gt; [x, x * 2]));\n// [1, 2, 2, 4, 3, 6]\n\n// Array-like objects returned from the callback won't be flattened\nconsole.log(\n  Array.prototype.flatMap.call(arrayLike, (x) =&gt; ({\n    length: 1,\n    0: x,\n  })),\n);\n// [ { '0': 1, length: 1 }, { '0': 2, length: 1 }, { '0': 3, length: 1 } ]\n</code></pre></div>"}},{"type":"specifications","value":{"id":"specifications","title":"Specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.flatmap","title":"ECMAScript Language Specification"}],"query":"javascript.builtins.Array.flatMap"}},{"type":"browser_compatibility","value":{"id":"browser_compatibility","title":"Browser compatibility","isH3":false,"query":"javascript.builtins.Array.flatMap"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n<li><a href=\"https://github.com/zloirock/core-js#ecmascript-array\" class=\"external\" target=\"_blank\">Polyfill of <code>Array.prototype.flatMap</code> in <code>core-js</code></a></li>\n<li><a href=\"/en-US/docs/Web/JavaScript/Guide/Indexed_collections\">Indexed collections</a> guide</li>\n<li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array\"><code>Array</code></a></li>\n<li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/concat\"><code>Array.prototype.concat()</code></a></li>\n<li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat\"><code>Array.prototype.flat()</code></a></li>\n<li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map\"><code>Array.prototype.map()</code></a></li>\n<li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce\"><code>Array.prototype.reduce()</code></a></li>\n</ul>"}}],"isActive":true,"isMarkdown":true,"isTranslated":false,"locale":"en-US","mdn_url":"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap","modified":"2023-11-27T08:17:23.000Z","native":"English (US)","noIndexing":false,"other_translations":[{"locale":"de","title":"Array.prototype.flatMap()","native":"Deutsch"},{"locale":"es","title":"Array.prototype.flatMap()","native":"Español"},{"locale":"fr","title":"Array.prototype.flatMap()","native":"Français"},{"locale":"ja","title":"Array.prototype.flatMap()","native":"日本語"},{"locale":"ko","title":"Array.prototype.flatMap()","native":"한국어"},{"locale":"pt-BR","title":"Array.prototype.flatMap()","native":"Português (do Brasil)"},{"locale":"ru","title":"Array.prototype.flatMap()","native":"Русский"},{"locale":"zh-CN","title":"Array.prototype.flatMap()","native":"中文 (简体)"}],"pageTitle":"Array.prototype.flatMap() - JavaScript | MDN","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/JavaScript","title":"JavaScript"},{"uri":"/en-US/docs/Web/JavaScript/Reference","title":"Reference"},{"uri":"/en-US/docs/Web/JavaScript/Reference/Global_Objects","title":"Standard built-in objects"},{"uri":"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array","title":"Array"},{"uri":"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap","title":"Array.prototype.flatMap()"}],"popularity":null,"short_title":"Array.prototype.flatMap()","sidebarHTML":"<ol><li class=\"section\"><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects\">Standard built-in objects</a></li><li class=\"section\"><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array\"><code>Array</code></a></li><li class=\"toggle\"><details open=\"\"><summary>Constructor</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Array\"><code>Array() constructor</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Static methods</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from\"><code>Array.from()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/fromAsync\"><code>Array.fromAsync()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray\"><code>Array.isArray()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/of\"><code>Array.of()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Static properties</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Symbol.species\"><code>Array[Symbol.species]</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Instance methods</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/at\"><code>Array.prototype.at()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/concat\"><code>Array.prototype.concat()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/copyWithin\"><code>Array.prototype.copyWithin()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/entries\"><code>Array.prototype.entries()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/every\"><code>Array.prototype.every()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/fill\"><code>Array.prototype.fill()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter\"><code>Array.prototype.filter()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find\"><code>Array.prototype.find()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex\"><code>Array.prototype.findIndex()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findLast\"><code>Array.prototype.findLast()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findLastIndex\"><code>Array.prototype.findLastIndex()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat\"><code>Array.prototype.flat()</code></a></li><li><em><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap\" aria-current=\"page\"><code>Array.prototype.flatMap()</code></a></em></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach\"><code>Array.prototype.forEach()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes\"><code>Array.prototype.includes()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf\"><code>Array.prototype.indexOf()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/join\"><code>Array.prototype.join()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/keys\"><code>Array.prototype.keys()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/lastIndexOf\"><code>Array.prototype.lastIndexOf()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map\"><code>Array.prototype.map()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/pop\"><code>Array.prototype.pop()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/push\"><code>Array.prototype.push()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce\"><code>Array.prototype.reduce()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight\"><code>Array.prototype.reduceRight()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reverse\"><code>Array.prototype.reverse()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/shift\"><code>Array.prototype.shift()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice\"><code>Array.prototype.slice()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some\"><code>Array.prototype.some()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort\"><code>Array.prototype.sort()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice\"><code>Array.prototype.splice()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/toLocaleString\"><code>Array.prototype.toLocaleString()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/toReversed\"><code>Array.prototype.toReversed()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/toSorted\"><code>Array.prototype.toSorted()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/toSpliced\"><code>Array.prototype.toSpliced()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/toString\"><code>Array.prototype.toString()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/unshift\"><code>Array.prototype.unshift()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/values\"><code>Array.prototype.values()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/with\"><code>Array.prototype.with()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Symbol.iterator\"><code>Array.prototype[Symbol.iterator]()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Instance properties</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/length\"><code>Array: length</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Symbol.unscopables\"><code>Array.prototype[Symbol.unscopables]</code></a></li></ol></details></li><li class=\"section\">Inheritance</li><li class=\"section\"><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object\"><code>Object/Function</code></a></li><li class=\"toggle\"><details><summary>Static methods</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply\"><code>Function.prototype.apply()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind\"><code>Function.prototype.bind()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call\"><code>Function.prototype.call()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/toString\"><code>Function.prototype.toString()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/Symbol.hasInstance\"><code>Function.prototype[Symbol.hasInstance]()</code></a></li></ol></details></li><li class=\"toggle\"><details><summary>Static properties</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/displayName\"><code>Function: displayName</code></a><abbr class=\"icon icon-nonstandard\" title=\"Non-standard. Check cross-browser support before using.\">\n<span class=\"visually-hidden\">Non-standard</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/length\"><code>Function: length</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\"><code>Function: name</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/prototype\"><code>Function: prototype</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/arguments\"><code>Function.prototype.arguments</code></a><abbr class=\"icon icon-nonstandard\" title=\"Non-standard. Check cross-browser support before using.\">\n<span class=\"visually-hidden\">Non-standard</span>\n</abbr><abbr class=\"icon icon-deprecated\" title=\"Deprecated. Not for use in new websites.\">\n<span class=\"visually-hidden\">Deprecated</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/caller\"><code>Function.prototype.caller</code></a><abbr class=\"icon icon-nonstandard\" title=\"Non-standard. Check cross-browser support before using.\">\n<span class=\"visually-hidden\">Non-standard</span>\n</abbr><abbr class=\"icon icon-deprecated\" title=\"Deprecated. Not for use in new websites.\">\n<span class=\"visually-hidden\">Deprecated</span>\n</abbr></li></ol></details></li><li class=\"toggle\"><details><summary>Instance methods</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineGetter__\"><code>Object.prototype.__defineGetter__()</code></a><abbr class=\"icon icon-deprecated\" title=\"Deprecated. Not for use in new websites.\">\n<span class=\"visually-hidden\">Deprecated</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineSetter__\"><code>Object.prototype.__defineSetter__()</code></a><abbr class=\"icon icon-deprecated\" title=\"Deprecated. Not for use in new websites.\">\n<span class=\"visually-hidden\">Deprecated</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupGetter__\"><code>Object.prototype.__lookupGetter__()</code></a><abbr class=\"icon icon-deprecated\" title=\"Deprecated. Not for use in new websites.\">\n<span class=\"visually-hidden\">Deprecated</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupSetter__\"><code>Object.prototype.__lookupSetter__()</code></a><abbr class=\"icon icon-deprecated\" title=\"Deprecated. Not for use in new websites.\">\n<span class=\"visually-hidden\">Deprecated</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty\"><code>Object.prototype.hasOwnProperty()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isPrototypeOf\"><code>Object.prototype.isPrototypeOf()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/propertyIsEnumerable\"><code>Object.prototype.propertyIsEnumerable()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toLocaleString\"><code>Object.prototype.toLocaleString()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString\"><code>Object.prototype.toString()</code></a></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/valueOf\"><code>Object.prototype.valueOf()</code></a></li></ol></details></li><li class=\"toggle\"><details><summary>Instance properties</summary><ol><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto\"><code>Object.prototype.__proto__</code></a><abbr class=\"icon icon-deprecated\" title=\"Deprecated. Not for use in new websites.\">\n<span class=\"visually-hidden\">Deprecated</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor\"><code>Object.prototype.constructor</code></a></li></ol></details></li></ol>","source":{"folder":"en-us/web/javascript/reference/global_objects/array/flatmap","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/javascript/reference/global_objects/array/flatmap/index.md","last_commit_url":"https://github.com/mdn/content/commit/57375b77984037c614982a9327bc96101824db89","filename":"index.md"},"summary":"The flatMap() method of Array instances returns a new array formed by applying a given callback function to each element of the array, and then flattening the result by one level. It is identical to a map() followed by a flat() of depth 1 (arr.map(...args).flat()), but slightly more efficient than calling those two methods separately.","title":"Array.prototype.flatMap()","toc":[{"text":"Try it","id":"try_it"},{"text":"Syntax","id":"syntax"},{"text":"Description","id":"description"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"baseline":{"baseline":"high","baseline_low_date":"2020-01-15","baseline_high_date":"2022-07-15","support":{"chrome":"69","chrome_android":"69","edge":"79","firefox":"62","firefox_android":"62","safari":"12","safari_ios":"12"}},"browserCompat":["javascript.builtins.Array.flatMap"],"pageType":"javascript-instance-method"}}</script>

</body><!-- Mirrored from developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 08 Jan 2025 13:10:02 GMT --></html>